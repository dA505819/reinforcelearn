<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multi-armed bandit — bandit â€¢ reinforcelearn</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">reinforcelearn</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/algorithms.html">How to solve an environment?</a>
    </li>
    <li>
      <a href="../articles/environments.html">How to create an environment?</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction to reinforcelearn</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/markdumke/reinforcelearn">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multi-armed bandit</h1>
    </div>

    
    <p>Different solution methods for multi-armed bandits.</p>
    

    <pre class="usage"><span class='fu'>bandit</span>(<span class='no'>rewardFun</span>, <span class='no'>n.actions</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>action.selection</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"egreedy"</span>, <span class='st'>"greedy"</span>, <span class='st'>"UCB"</span>, <span class='st'>"gradientbandit"</span>),
  <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>initial.value</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>initial.visits</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>C</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>updateEpsilon</span> <span class='kw'>=</span> <span class='no'>identity2</span>, <span class='kw'>updateAlpha</span> <span class='kw'>=</span> <span class='no'>identity2</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>rewardFun</th>
      <td><p>[<code>function</code>] 
A function, which takes an action (<code>integer(1)</code>) as first argument
and returns a numeric scalar reward.</p></td>
    </tr>
    <tr>
      <th>n.actions</th>
      <td><p>[<code>integer(1)</code>] 
Number of actions.</p></td>
    </tr>
    <tr>
      <th>n.episodes</th>
      <td><p>[<code>integer(1)</code>] 
Number of episodes.</p></td>
    </tr>
    <tr>
      <th>action.selection</th>
      <td><p>[<code>character(1)</code>] 
Which method to use for action selection, one of <code>"egreedy"</code>,
<code>"greedy"</code>, <code>"UCB"</code> or <code>"gradientbandit"</code>.</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>[<code>numeric(1) in [0,1]</code>] 
Ratio of random exploration in epsilon-greedy action selection.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>[<code>numeric(1)</code>] 
Parameter of the gradient bandit algorithm, a higher alpha value gives more weight to
recent rewards (useful for non-stationary environments).</p></td>
    </tr>
    <tr>
      <th>initial.value</th>
      <td><p>[<code>numeric(1)</code>] 
Initial values for the action values Q, set this to the maximal possible
reward to encourage exploration (optimistic initialization).</p></td>
    </tr>
    <tr>
      <th>initial.visits</th>
      <td><p>[<code>integer(1)</code>] 
Set this to a high number to encourage exploration
(together with a high <code>initial.value</code>).</p></td>
    </tr>
    <tr>
      <th>C</th>
      <td><p>[<code>numeric(1)</code>] 
Controls the degree of exploration. High C values lead to more exploration.</p></td>
    </tr>
    <tr>
      <th>updateEpsilon</th>
      <td><p>[<code>function</code>] 
A function which takes two arguments, <code>epsilon</code> and the current number of episodes.
Could be used to decay the parameter over time.</p></td>
    </tr>
    <tr>
      <th>updateAlpha</th>
      <td><p>[<code>function</code>] 
A function which takes two arguments, <code>alpha</code> and the current number of episodes.
Could be used to decay the parameter over time.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>[<code>numeric</code>] 
Returns the action values for the arms of the bandit or,
for gradient-bandit action selection, the probabilities for
each action.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Multi-armed bandits are a simplified reinforcement learning problem,
each arm of the bandit pays off a reward and the goal is to maximize
this reward, i.e. to choose the best arm. The arms of the bandit
can be seen as actions, after each action the episode ends (there
are no states). To find the best action, the algorithm is faced with
a tradeoff between exploration and exploitation.</p>
<p>Actions are numerated starting with 0!</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>set.seed</span>(<span class='fl'>123</span>)

<span class='co'># Define reward function</span>
<span class='no'>rewardFun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>action</span>) {
  <span class='kw'>if</span> (<span class='no'>action</span> <span class='kw'>==</span> <span class='fl'>0</span>) {
    <span class='no'>reward</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='fl'>1</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>1</span>)
  }
  <span class='kw'>if</span> (<span class='no'>action</span> <span class='kw'>==</span> <span class='fl'>1</span>) {
    <span class='no'>reward</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='fl'>1</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>4</span>)
  }
  <span class='kw'>if</span> (<span class='no'>action</span> <span class='kw'>==</span> <span class='fl'>2</span>) {
    <span class='no'>reward</span> <span class='kw'>=</span> <span class='fu'>runif</span>(<span class='fl'>1</span>, <span class='kw'>min</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>5</span>)
  }
  <span class='kw'>if</span> (<span class='no'>action</span> <span class='kw'>==</span> <span class='fl'>3</span>) {
    <span class='no'>reward</span> <span class='kw'>=</span> <span class='fu'>rexp</span>(<span class='fl'>1</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='fl'>0.25</span>)
  }
  <span class='no'>reward</span>
}

<span class='fu'>bandit</span>(<span class='no'>rewardFun</span>, <span class='kw'>n.actions</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>action.selection</span> <span class='kw'>=</span> <span class='st'>"greedy"</span>)</div><div class='output co'>#&gt; [1] 0.9938972 1.6475474 2.4775240 0.1263094</div><div class='input'><span class='fu'>bandit</span>(<span class='no'>rewardFun</span>, <span class='kw'>n.actions</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>action.selection</span> <span class='kw'>=</span> <span class='st'>"egreedy"</span>, <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)</div><div class='output co'>#&gt; [1] 1.091109 1.810578 2.368114 3.973869</div><div class='input'><span class='fu'>bandit</span>(<span class='no'>rewardFun</span>, <span class='kw'>n.actions</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>action.selection</span> <span class='kw'>=</span> <span class='st'>"greedy"</span>,
  <span class='kw'>initial.value</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>initial.visits</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt; [1] 4.175454 4.132243 4.152457 4.208284</div><div class='input'><span class='fu'>bandit</span>(<span class='no'>rewardFun</span>, <span class='kw'>n.actions</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>action.selection</span> <span class='kw'>=</span> <span class='st'>"UCB"</span>, <span class='kw'>C</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; [1] -0.1064495  2.5144118  2.7020018  4.0096271</div><div class='input'><span class='co'># true values: 1, 2, 2.5, 4</span>

<span class='co'># Gradient bandit algorithm</span>
<span class='fu'>bandit</span>(<span class='no'>rewardFun</span>, <span class='kw'>n.actions</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>action.selection</span> <span class='kw'>=</span> <span class='st'>"gradientbandit"</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.1</span>)</div><div class='output co'>#&gt; [1] 0.0000690247 0.0001050642 0.0003705861 0.9994553250</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Markus Dumke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
