<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Dynamic Programming — evaluatePolicy â€¢ reinforcelearn</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">reinforcelearn</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/algorithms.html">How to solve an environment?</a>
    </li>
    <li>
      <a href="../articles/environments.html">Environments</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dynamic Programming</h1>
    </div>

    
    <p>These functions solve a Markov Decision Process using a model of the environment.
<code>evaluatePolicy</code> evaluates a given policy,
<code>iteratePolicy</code> and <code>iterateValue</code> can be used to find the optimal policy.</p>
    

    <pre class="usage"><span class='fu'>evaluatePolicy</span>(<span class='no'>envir</span>, <span class='no'>policy</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>discount</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>precision</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>, <span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>iteratePolicy</span>(<span class='no'>envir</span>, <span class='kw'>policy</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>discount</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>precision.eval</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>, <span class='kw'>n.iter.eval</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>iterateValue</span>(<span class='no'>envir</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>discount</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>precision</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>,
  <span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>envir</th>
      <td><p>[<code>R6 class</code>] 
The reinforcement learning environment created by <code><a href='makeEnvironment.html'>makeEnvironment</a></code>.</p></td>
    </tr>
    <tr>
      <th>policy</th>
      <td><p>[<code>matrix(n.states x n.actions)</code>] 
A policy specified as a probability matrix (states x actions).</p></td>
    </tr>
    <tr>
      <th>v</th>
      <td><p>[<code>numeric(n.states)</code>] 
Initial state value function. Terminal states must have a value of 0!</p></td>
    </tr>
    <tr>
      <th>q</th>
      <td><p>[<code>matrix(n.states x n.actions)</code>] 
Initial action value function. Terminal states must have a value of 0!</p></td>
    </tr>
    <tr>
      <th>discount</th>
      <td><p>[<code>numeric(1) in [0, 1]</code>] 
Discount factor.</p></td>
    </tr>
    <tr>
      <th>precision</th>
      <td><p>[<code>numeric(1)</code>] 
Algorithm stops when improvement is
smaller than precision.</p></td>
    </tr>
    <tr>
      <th>n.iter</th>
      <td><p>[<code>integer(1)</code>] 
Number of iterations. If supplied the <code>precision</code> argument will be ignored.</p></td>
    </tr>
    <tr>
      <th>precision.eval</th>
      <td><p>[numeric(1)] 
Policy evaluation stops when improvement is smaller than precision.</p></td>
    </tr>
    <tr>
      <th>n.iter.eval</th>
      <td><p>[integer(1)] 
Number of iterations per evaluation step.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>[<code>list(3)</code>] 
Returns the state value function [<code>numeric</code>], the
action value function [<code>matrix</code>]
and the policy [<code>matrix</code>].</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>evaluatePolicy</code> runs until the improvement in the state value
function in two subsequent steps is smaller than the given precision in all states or if the
specified number of iterations is exhausted.</p>
<p>Both <code>iteratePolicy</code> and <code>iterateValue</code> alternate between evaluating a policy and
improving the current policy by acting greedily with respect to the current policy's value function.
The difference between these two algorithms is that
<code>iteratePolicy</code> evaluates the policy until some stop criterion is met,
while <code>iterateValue</code> evaluates each policy only one step and
then immediately improves upon the current policy.</p>
<p>When the <code>policy</code> argument is <code>NULL</code> the initial policy will be a uniform random policy.
    <code>iteratePolicy</code> stops if the policy does not change in two subsequent iterations or if the
specified number of iterations is exhausted. For the policy evaluation step in policy iteration
the same stop criteria mentioned above are applied.
    <code>iterateValue</code> runs until the improvement in the value
function in two subsequent steps
is smaller than the given precision in all states or if the
specified number of iterations is exhausted.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Sutton and Barto (Book draft 2017): Reinforcement Learning: An Introduction. Chapter 4.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Set up gridworld problem</span>
<span class='no'>env</span> <span class='kw'>=</span> <span class='fu'><a href='makeEnvironment.html'>makeEnvironment</a></span>(<span class='st'>"Gridworld"</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>4</span>, <span class='fl'>4</span>), <span class='kw'>goal.states</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>15</span>))

<span class='co'># Define uniform random policy, take each action with equal probability</span>
<span class='no'>random.policy</span> <span class='kw'>=</span> <span class='fu'>matrix</span>(<span class='fl'>1</span> / <span class='no'>env</span>$<span class='no'>n.actions</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>env</span>$<span class='no'>n.states</span>,
  <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='no'>env</span>$<span class='no'>n.actions</span>)

<span class='co'># Evaluate given policy</span>
<span class='no'>res</span> <span class='kw'>=</span> <span class='fu'>evaluatePolicy</span>(<span class='no'>env</span>, <span class='no'>random.policy</span>, <span class='kw'>precision</span> <span class='kw'>=</span> <span class='fl'>0.001</span>)
<span class='fu'>print</span>(<span class='fu'>round</span>(<span class='fu'>matrix</span>(<span class='no'>res</span>$<span class='no'>v</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)))</div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4]
#&gt; [1,]    0  -14  -20  -22
#&gt; [2,]  -14  -18  -20  -20
#&gt; [3,]  -20  -20  -18  -14
#&gt; [4,]  -22  -20  -14    0</div><div class='input'>
<span class='co'># Find optimal policy using Policy Iteration</span>
<span class='no'>res</span> <span class='kw'>=</span> <span class='fu'>iteratePolicy</span>(<span class='no'>env</span>)
<span class='fu'>print</span>(<span class='fu'>round</span>(<span class='fu'>matrix</span>(<span class='no'>res</span>$<span class='no'>v</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)))</div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4]
#&gt; [1,]    0   -1   -2   -3
#&gt; [2,]   -1   -2   -3   -2
#&gt; [3,]   -2   -3   -2   -1
#&gt; [4,]   -3   -2   -1    0</div><div class='input'>
<span class='co'># Find optimal policy using Value Iteration</span>
<span class='no'>res</span> <span class='kw'>=</span> <span class='fu'>iterateValue</span>(<span class='no'>env</span>)
<span class='fu'>print</span>(<span class='no'>res</span>$<span class='no'>policy</span>)</div><div class='output co'>#&gt;       [,1] [,2] [,3] [,4]
#&gt;  [1,]    1    0    0    0
#&gt;  [2,]    1    0    0    0
#&gt;  [3,]    1    0    0    0
#&gt;  [4,]    1    0    0    0
#&gt;  [5,]    0    0    1    0
#&gt;  [6,]    1    0    0    0
#&gt;  [7,]    1    0    0    0
#&gt;  [8,]    0    0    0    1
#&gt;  [9,]    0    0    1    0
#&gt; [10,]    1    0    0    0
#&gt; [11,]    0    1    0    0
#&gt; [12,]    0    0    0    1
#&gt; [13,]    0    1    0    0
#&gt; [14,]    0    1    0    0
#&gt; [15,]    0    1    0    0
#&gt; [16,]    1    0    0    0</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Markus Dumke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
