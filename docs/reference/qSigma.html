<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Q(sigma) / Q-Learning / Sarsa / Expected Sarsa — qSigma â€¢ reinforcelearn</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">reinforcelearn</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/algorithms.html">How to solve an environment?</a>
    </li>
    <li>
      <a href="../articles/environments.html">How to create an environment?</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction to reinforcelearn</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/markdumke/reinforcelearn">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Q(sigma) / Q-Learning / Sarsa / Expected Sarsa</h1>
    </div>

    
    <p>Value-based reinforcement learning control algorithms.</p>
    

    <pre class="usage"><span class='fu'>qSigma</span>(<span class='no'>envir</span>, <span class='kw'>fun.approx</span> <span class='kw'>=</span> <span class='st'>"table"</span>, <span class='kw'>preprocessState</span> <span class='kw'>=</span> <span class='no'>identity</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>initial.value</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.states</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>target.policy</span> <span class='kw'>=</span> <span class='st'>"egreedy"</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>eligibility.type</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>learning.rate</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>discount</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>double.learning</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>update.target.after</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>replay.memory</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>replay.memory.size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>batch.size</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>updateEpsilon</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateSigma</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>updateLambda</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateAlpha</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateLearningRate</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>qlearning</span>(<span class='no'>envir</span>, <span class='kw'>fun.approx</span> <span class='kw'>=</span> <span class='st'>"table"</span>, <span class='kw'>preprocessState</span> <span class='kw'>=</span> <span class='no'>identity</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>initial.value</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.states</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>eligibility.type</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>learning.rate</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>discount</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>double.learning</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>update.target.after</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>replay.memory</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>replay.memory.size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>batch.size</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>updateEpsilon</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateSigma</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>updateLambda</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateAlpha</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateLearningRate</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>sarsa</span>(<span class='no'>envir</span>, <span class='kw'>fun.approx</span> <span class='kw'>=</span> <span class='st'>"table"</span>, <span class='kw'>preprocessState</span> <span class='kw'>=</span> <span class='no'>identity</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>initial.value</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.states</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>eligibility.type</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>learning.rate</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>discount</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>double.learning</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>update.target.after</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>replay.memory</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>replay.memory.size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>batch.size</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>updateEpsilon</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateSigma</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>updateLambda</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateAlpha</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateLearningRate</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>expectedSarsa</span>(<span class='no'>envir</span>, <span class='kw'>fun.approx</span> <span class='kw'>=</span> <span class='st'>"table"</span>, <span class='kw'>preprocessState</span> <span class='kw'>=</span> <span class='no'>identity</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>initial.value</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.states</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.episodes</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>target.policy</span> <span class='kw'>=</span> <span class='st'>"egreedy"</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>eligibility.type</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>learning.rate</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>discount</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>double.learning</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>update.target.after</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>replay.memory</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>replay.memory.size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>batch.size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0.01</span>,
  <span class='kw'>updateEpsilon</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateSigma</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateLambda</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>updateAlpha</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>updateLearningRate</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>envir</th>
      <td><p>[<code>R6 class</code>] 
The reinforcement learning environment created by <code><a href='makeEnvironment.html'>makeEnvironment</a></code>.</p></td>
    </tr>
    <tr>
      <th>fun.approx</th>
      <td><p>[<code>character(1)</code>] 
How to represent the value function? Currently <code>"table"</code>, <code>"linear"</code>
and <code>"neural.network"</code> are supported.</p></td>
    </tr>
    <tr>
      <th>preprocessState</th>
      <td><p>[<code>function</code>] 
A function that takes the state observation returned from the environment as an input and
preprocesses this in a way the algorithm can work with it.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>[<code>keras model</code>] 
A neural network model specified using the <code>keras</code> package.
See Details for more information.</p></td>
    </tr>
    <tr>
      <th>initial.value</th>
      <td><p>[<code>numeric</code>] 
Initial value function matrix or weight matrix. 
If <code>NULL</code> weights will be initialized to 0. 
Only used for tabular or linear function approximation.</p></td>
    </tr>
    <tr>
      <th>n.states</th>
      <td><p>[<code>integer(1)</code>] 
Number of states for tabular value function. 
Only needed if the state space is continuous, but
will be transformed by <code>preprocessState</code>, so that a single integer value is returned. 
Else the number of states is accessed from the <code>envir</code> argument.</p></td>
    </tr>
    <tr>
      <th>n.episodes</th>
      <td><p>[<code>integer(1)</code>] 
Number of episodes.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>[<code>numeric(1) in [0, 1]</code>] 
Parameter of the Q(sigma) algorithm. It controls if the temporal-difference target
is equal to the sarsa target (for <code>sigma = 1</code>) or the expected sarsa target
(for <code>sigma = 0</code>). For intermediate values of <code>sigma</code> a weighted mean
between the two targets is used.</p></td>
    </tr>
    <tr>
      <th>target.policy</th>
      <td><p>[<code>character(1)</code>] 
Should the temporal-difference target be computed on-policy
using the epsilon-greedy behavior policy (<code>target.policy = "egreedy"</code>)
or off-policy using a greedy policy in the
expected sarsa part of the update (<code>target.policy = "greedy"</code>)?</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>[<code>numeric(1) in [0, 1]</code>] 
Eligibility trace decay parameter.</p></td>
    </tr>
    <tr>
      <th>eligibility.type</th>
      <td><p>[<code>numeric(1)</code>] 
Type of eligibility trace, use <code>eligibility.type = 1</code> for replacing traces,
<code>eligibility.type = 0</code> for accumulating traces or intermediate values for a mixture between both.</p></td>
    </tr>
    <tr>
      <th>learning.rate</th>
      <td><p>[<code>numeric(1)</code>] 
Learning rate used for gradient descent.</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>[<code>numeric(1) in [0, 1]</code>] 
Ratio of random exploration in epsilon-greedy action selection.</p></td>
    </tr>
    <tr>
      <th>discount</th>
      <td><p>[<code>numeric(1) in [0, 1]</code>] 
Discount factor.</p></td>
    </tr>
    <tr>
      <th>double.learning</th>
      <td><p>[<code>logical(1)</code>] 
Should double learning be used?</p></td>
    </tr>
    <tr>
      <th>update.target.after</th>
      <td><p>[<code>integer(1)</code>] 
When using double learning the target network / table will be updated after
<code>update.target.after</code> steps.</p></td>
    </tr>
    <tr>
      <th>replay.memory</th>
      <td><p>[<code>list</code>] 
Initial replay memory, which can be passed on. 
Each list element must be a list containing state, action,
reward and next.state.</p></td>
    </tr>
    <tr>
      <th>replay.memory.size</th>
      <td><p>[<code>integer(1)</code>] 
Size of the replay memory. Only used if <code>replay.memory</code> is <code>NULL</code>. Then
the replay memory will be initially filled with experiences following a uniform random policy.</p></td>
    </tr>
    <tr>
      <th>batch.size</th>
      <td><p>[<code>integer(1)</code>] 
Batch size, how many experiences are sampled from the replay memory at each step?
Must be smaller than the size of the replay memory!</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>[<code>numeric(1) in [0, 1]</code>] 
If <code>alpha = 0</code> sampling from replay memory will be uniform, otherwise observations with
high temporal-difference error will be proportionally prioritized.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>[<code>numeric(1) in (0, 1]</code>] 
<code>theta</code> is a small positive constant that prevents the edge-case of transitions
in the replay memory not being revisited once their TD error is zero.</p></td>
    </tr>
    <tr>
      <th>updateEpsilon</th>
      <td><p>[<code>function</code>] 
A function that updates <code>epsilon</code>. It takes two arguments, 
<code>epsilon</code> and the current number of episodes which are finished, 
and returns the new <code>epsilon</code> value.</p></td>
    </tr>
    <tr>
      <th>updateSigma</th>
      <td><p>[<code>function</code>] 
A function that updates <code>sigma</code>. It takes two arguments, 
<code>sigma</code> and the current number of episodes which are finished, 
and returns the new <code>sigma</code> value.</p></td>
    </tr>
    <tr>
      <th>updateLambda</th>
      <td><p>[<code>function</code>] 
A function that updates <code>lambda</code>. It takes two arguments, 
<code>lambda</code> and the current number
of episodes which are finished, and returns the new <code>lambda</code> value.</p></td>
    </tr>
    <tr>
      <th>updateAlpha</th>
      <td><p>[<code>function</code>] 
A function that updates <code>alpha</code>. It takes two arguments, 
<code>alpha</code> and the current number
of episodes which are finished, and returns the new <code>alpha</code> value.</p></td>
    </tr>
    <tr>
      <th>updateLearningRate</th>
      <td><p>[<code>function</code>] 
A function that updates the learning rate. It takes two arguments, <code>learning.rate</code>
and the current number of episodes which are finished, and returns the new
<code>learning.rate</code> value.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>[<code>list(4)</code>] 
  Returns the action value function or model parameters [<code>matrix</code>] and the
  number of steps per episode [<code>numeric</code>]
  and the sum of all rewards in the episode [<code>numeric</code>].</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>You must specify the reinforcement learning environment using the <code>envir</code> argument.
It takes an <code>R6 class</code> created by <code><a href='makeEnvironment.html'>makeEnvironment</a></code> as input.
See documentation there.</p>
<p>The algorithms can be used to find the optimal action value function using the principle
of generalized policy iteration. They all learn online using temporal-difference learning.
Q(sigma) subsumes the well known Q-Learning, Sarsa and Expected Sarsa algorithms as special cases.
The default call <code>qsigma()</code> is exactly equivalent to Sarsa(0). A weighted mean between sarsa
and expected sarsa updates can be used by varying the parameter <code>sigma</code>.
When <code>target.policy == "egreedy"</code> the policy used to compute the expected sarsa is the epsilon-greedy
policy used for action selection, when <code>target.policy == "greedy"</code> a greedy target policy will be
used as in Q-Learning. See De Asis et al. (2017) for more details.</p>
<p>The functions <code>qlearning</code> and <code>sarsa</code> are there for convenience.
They call the <code>qSigma</code> function with a special set of parameters.</p>
<p>When <code>fun.approx == "table"</code> the action value function will be represented using a table,
a linear combination of features and a neural network can also be used. For a neural network you
need to pass on a keras model via the <code>model</code> argument. This way it is possible to
construct a Deep Q-Network (DQN).</p>
<p>The raw state observation returned from the environment can be preprocessed using
the <code>preprocessState</code> function. This function takes the state observation as input and
returns a preprocessed state which can be directly used by the function approximator.
This is especially important when using function approximation.</p>
<p>Experience replay can be used by specifying a prefilled replay memory through the
<code>replay.memory</code> argument or by specifying the length of the replay memory,
which will then be filled with random experience. Using the defaults experiences are sampled
uniformly, a proportional prioritization proposed by Schaul et al. (2016) can also be used by
varying the parameters <code>alpha</code> and <code>theta</code>.</p>
<p>Using eligibility traces the one-step algorithms can be extended to multi-step algorithms. The
parameter <code>lambda</code> controls the tradeoff between one-step and multi-step methods. Three
different kinds of eligibility traces are implemented, accumulating, replacing and dutch traces.
See Sutton and Barto (Book draft 2017, Chapter 12) for more details.
This only works if no experience replay is used, i.e. <code>replay.memory.size == 1</code> and for a
tabular value function.</p>
<p>Double Learning can be used with all of the functions.
Then two Q value functions are used, Q1 for action selection and
Q2 for action evaluation. After a number of steps the weights of Q2 are replaced by the weights
of Q1. See Hasselt et al. (2015) for details.</p>
<p>The hyperparameters <code>epsilon</code>, <code>theta</code>, <code>sigma</code>, <code>alpha</code>, <code>lambda</code> and
<code>learning.rate</code> can be changed over time. Therefore pass on functions that return a new
value of the hyperparameter. These updates will be applied after each episode. First argument of
the function must be the parameter itself, the second argument is the current episode number.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>De Asis et al. (2017): Multi-step Reinforcement Learning: A Unifying Algorithm</p>
<p>Hasselt et al. (2015): Deep Reinforcement Learning with Double Q-Learning</p>
<p>Mnih et al. (2013): Playing Atari with Deep Reinforcement Learning</p>
<p>Schaul et al. (2016): Prioritized Experience Replay</p>
<p>Sutton and Barto (Book draft 2017): Reinforcement Learning: An Introduction</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Solve Windy Gridworld</span>
<span class='no'>env</span> <span class='kw'>=</span> <span class='fu'><a href='windyGridworld.html'>windyGridworld</a></span>()

<span class='fu'>qSigma</span>(<span class='no'>env</span>, <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)</div><div class='output co'>#&gt; <span class='message'>Episode 1 finished after 683 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 2 finished after 1727 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 3 finished after 814 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 4 finished after 235 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 5 finished after 725 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 6 finished after 178 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 7 finished after 89 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 8 finished after 393 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 9 finished after 265 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 10 finished after 204 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 11 finished after 364 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 12 finished after 198 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 13 finished after 102 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 14 finished after 152 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 15 finished after 126 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 16 finished after 205 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 17 finished after 39 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 18 finished after 57 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 19 finished after 189 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 20 finished after 168 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 21 finished after 224 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 22 finished after 152 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 23 finished after 99 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 24 finished after 49 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 25 finished after 149 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 26 finished after 49 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 27 finished after 160 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 28 finished after 98 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 29 finished after 139 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 30 finished after 108 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 31 finished after 100 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 32 finished after 103 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 33 finished after 199 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 34 finished after 34 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 35 finished after 114 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 36 finished after 48 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 37 finished after 126 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 38 finished after 79 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 39 finished after 97 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 40 finished after 80 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 41 finished after 37 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 42 finished after 118 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 43 finished after 84 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 44 finished after 124 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 45 finished after 139 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 46 finished after 33 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 47 finished after 139 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 48 finished after 38 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 49 finished after 151 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 50 finished after 91 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 51 finished after 25 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 52 finished after 42 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 53 finished after 63 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 54 finished after 162 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 55 finished after 76 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 56 finished after 39 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 57 finished after 37 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 58 finished after 57 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 59 finished after 53 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 60 finished after 82 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 61 finished after 56 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 62 finished after 26 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 63 finished after 152 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 64 finished after 96 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 65 finished after 146 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 66 finished after 20 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 67 finished after 92 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 68 finished after 107 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 69 finished after 27 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 70 finished after 74 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 71 finished after 47 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 72 finished after 65 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 73 finished after 40 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 74 finished after 93 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 75 finished after 42 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 76 finished after 81 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 77 finished after 88 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 78 finished after 100 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 79 finished after 28 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 80 finished after 36 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 81 finished after 39 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 82 finished after 81 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 83 finished after 103 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 84 finished after 37 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 85 finished after 23 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 86 finished after 34 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 87 finished after 41 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 88 finished after 63 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 89 finished after 89 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 90 finished after 37 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 91 finished after 37 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 92 finished after 89 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 93 finished after 139 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 94 finished after 39 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 95 finished after 82 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 96 finished after 31 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 97 finished after 59 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 98 finished after 111 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 99 finished after 52 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 100 finished after 29 time steps.</span></div><div class='output co'>#&gt; $Q1
#&gt;             [,1]       [,2]       [,3]       [,4]
#&gt;  [1,] -7.2234779 -7.2244536 -7.4018638 -7.2083677
#&gt;  [2,] -7.4212304 -7.3970078 -7.4908275 -7.4587709
#&gt;  [3,] -7.9280242 -7.8824972 -8.0812059 -7.9137849
#&gt;  [4,] -8.6598889 -8.6898898 -8.8313227 -8.6811601
#&gt;  [5,] -9.2832565 -9.3865006 -9.3663565 -9.2789871
#&gt;  [6,] -9.5500541 -9.5327604 -9.5944379 -9.5996490
#&gt;  [7,] -8.9388096 -8.8740374 -8.9413056 -8.9634087
#&gt;  [8,] -8.5447319 -7.9285913 -8.0305161 -7.9917676
#&gt;  [9,] -7.3082952 -6.9650545 -7.0360128 -7.1354466
#&gt; [10,] -6.1338077 -6.0747338 -6.0972670 -5.9895034
#&gt; [11,] -7.0770763 -7.0048868 -7.0011094 -7.1287178
#&gt; [12,] -7.1445124 -7.1535693 -7.0523560 -7.0941798
#&gt; [13,] -7.2806115 -7.2983655 -7.2757152 -7.2330159
#&gt; [14,] -7.6607581 -7.6746126 -7.8355238 -7.8040834
#&gt; [15,] -7.8533257 -8.2154338 -8.0665882 -7.9425486
#&gt; [16,] -7.5335477 -7.3845563 -7.7863091 -7.3917699
#&gt; [17,] -6.3031136 -6.2947254 -6.3328440 -6.2927105
#&gt; [18,] -5.3103922 -5.1840003 -5.2974257 -5.0819867
#&gt; [19,] -5.6798845 -5.3066803 -5.2077146 -5.3125316
#&gt; [20,] -5.2436773 -5.1000498 -5.1169682 -5.0040384
#&gt; [21,] -7.0351635 -6.8178943 -6.8503745 -6.8292789
#&gt; [22,] -6.6517769 -6.6441162 -6.7799106 -6.6416602
#&gt; [23,] -6.5672349 -6.6701668 -6.5979359 -6.6032832
#&gt; [24,] -6.9457939 -7.0728679 -6.8876055 -6.9550035
#&gt; [25,] -6.3778030 -6.5396268 -6.5711249 -6.5045170
#&gt; [26,] -5.7503795 -5.4093018 -5.8637758 -5.5674142
#&gt; [27,] -4.4490334 -4.9657956 -4.6245493 -4.5007067
#&gt; [28,] -3.3245370 -2.6995006 -3.1826334 -2.8250251
#&gt; [29,] -4.0762587 -4.0077579 -4.1146593 -3.9966158
#&gt; [30,] -4.1453446 -4.1820634 -4.1947505 -4.0124914
#&gt; [31,] -6.7721074 -6.6857207 -6.6554089 -6.6704199
#&gt; [32,] -6.3071817 -6.2464410 -6.2199040 -6.2436605
#&gt; [33,] -6.0361603 -5.9806568 -6.0022801 -5.9718267
#&gt; [34,] -6.0684440 -6.0180291 -6.2046666 -6.1266186
#&gt; [35,] -5.2266594 -5.2778911 -5.7143459 -5.1770286
#&gt; [36,] -3.8295718 -3.7045728 -4.0777539 -3.7403585
#&gt; [37,] -3.0674664 -2.8318314 -3.0957471 -2.6016887
#&gt; [38,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [39,] -2.7185927 -2.8529056 -3.0225747 -2.7360044
#&gt; [40,] -3.0977155 -3.0983684 -3.2993574 -3.0126949
#&gt; [41,] -6.0493772 -6.0236280 -6.1023869 -6.0041115
#&gt; [42,] -5.7103158 -5.6979801 -5.7723317 -5.6896613
#&gt; [43,] -5.3990833 -5.3865980 -5.4120948 -5.3057090
#&gt; [44,] -5.1515328 -5.2366855 -5.3149400 -5.3156546
#&gt; [45,] -4.1502020 -3.7277773 -3.8236416 -3.9272940
#&gt; [46,] -2.7068606 -2.5843200 -2.5563877 -2.6766269
#&gt; [47,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [48,] -0.6127274 -0.6310509 -0.7768894 -0.4685590
#&gt; [49,] -0.9999500 -1.4257337 -1.4051418 -1.0287508
#&gt; [50,] -2.0124296 -2.1604197 -2.3936462 -2.0383937
#&gt; [51,] -5.5435787 -5.4480412 -5.4956981 -5.4205417
#&gt; [52,] -5.1308531 -5.1521411 -5.2434075 -5.1121585
#&gt; [53,] -4.7159559 -4.6817731 -4.6768752 -4.7074017
#&gt; [54,] -4.3068657 -4.1388662 -4.2470596 -4.1664974
#&gt; [55,] -2.8688833 -2.8404717 -3.0970054 -2.8647900
#&gt; [56,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [57,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [58,] -0.1003118 -0.1273890 -0.2568038 -0.1321871
#&gt; [59,] -0.9183247 -1.0827846 -1.0326120 -0.9167524
#&gt; [60,] -1.4077899 -1.5028735 -1.4858191 -1.3264308
#&gt; [61,] -5.0678269 -5.0487644 -5.0377689 -5.0370483
#&gt; [62,] -4.6633034 -4.6814354 -4.7047593 -4.7532153
#&gt; [63,] -4.1521971 -4.1091949 -4.1083818 -4.0988057
#&gt; [64,] -3.6887411 -3.3613639 -3.7046054 -3.2767966
#&gt; [65,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [66,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [67,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [68,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [69,] -0.3448908 -0.4870400 -0.3122221 -0.4211314
#&gt; [70,] -0.8335384 -0.9135473 -0.9191832 -0.8072226
#&gt; 
#&gt; $Q2
#&gt; NULL
#&gt; 
#&gt; $steps
#&gt;   [1]  683 1727  814  235  725  178   89  393  265  204  364  198  102  152  126
#&gt;  [16]  205   39   57  189  168  224  152   99   49  149   49  160   98  139  108
#&gt;  [31]  100  103  199   34  114   48  126   79   97   80   37  118   84  124  139
#&gt;  [46]   33  139   38  151   91   25   42   63  162   76   39   37   57   53   82
#&gt;  [61]   56   26  152   96  146   20   92  107   27   74   47   65   40   93   42
#&gt;  [76]   81   88  100   28   36   39   81  103   37   23   34   41   63   89   37
#&gt;  [91]   37   89  139   39   82   31   59  111   52   29
#&gt; </div><div class='input'><span class='fu'>qlearning</span>(<span class='no'>env</span>)</div><div class='output co'>#&gt; <span class='message'>Episode 1 finished after 631 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 2 finished after 1965 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 3 finished after 431 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 4 finished after 604 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 5 finished after 198 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 6 finished after 546 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 7 finished after 306 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 8 finished after 191 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 9 finished after 176 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 10 finished after 269 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 11 finished after 240 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 12 finished after 100 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 13 finished after 181 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 14 finished after 320 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 15 finished after 100 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 16 finished after 97 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 17 finished after 285 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 18 finished after 190 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 19 finished after 75 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 20 finished after 109 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 21 finished after 190 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 22 finished after 65 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 23 finished after 71 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 24 finished after 87 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 25 finished after 156 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 26 finished after 95 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 27 finished after 156 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 28 finished after 71 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 29 finished after 133 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 30 finished after 127 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 31 finished after 219 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 32 finished after 43 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 33 finished after 178 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 34 finished after 57 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 35 finished after 38 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 36 finished after 60 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 37 finished after 74 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 38 finished after 143 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 39 finished after 34 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 40 finished after 174 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 41 finished after 28 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 42 finished after 93 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 43 finished after 160 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 44 finished after 85 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 45 finished after 58 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 46 finished after 53 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 47 finished after 204 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 48 finished after 44 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 49 finished after 41 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 50 finished after 59 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 51 finished after 147 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 52 finished after 65 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 53 finished after 54 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 54 finished after 145 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 55 finished after 34 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 56 finished after 32 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 57 finished after 43 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 58 finished after 89 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 59 finished after 134 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 60 finished after 36 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 61 finished after 80 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 62 finished after 64 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 63 finished after 99 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 64 finished after 74 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 65 finished after 60 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 66 finished after 112 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 67 finished after 75 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 68 finished after 49 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 69 finished after 23 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 70 finished after 104 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 71 finished after 65 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 72 finished after 41 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 73 finished after 29 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 74 finished after 190 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 75 finished after 59 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 76 finished after 50 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 77 finished after 95 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 78 finished after 44 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 79 finished after 34 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 80 finished after 78 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 81 finished after 102 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 82 finished after 25 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 83 finished after 63 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 84 finished after 35 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 85 finished after 92 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 86 finished after 36 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 87 finished after 142 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 88 finished after 86 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 89 finished after 28 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 90 finished after 72 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 91 finished after 76 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 92 finished after 48 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 93 finished after 69 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 94 finished after 57 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 95 finished after 40 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 96 finished after 31 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 97 finished after 41 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 98 finished after 41 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 99 finished after 140 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 100 finished after 27 time steps.</span></div><div class='output co'>#&gt; $Q1
#&gt;             [,1]       [,2]       [,3]       [,4]
#&gt;  [1,] -7.3320675 -7.3604834 -7.3981540 -7.2732897
#&gt;  [2,] -7.4726233 -7.6026126 -7.4980246 -7.5631220
#&gt;  [3,] -7.9837899 -7.9434152 -8.0205115 -7.9720813
#&gt;  [4,] -8.7040072 -8.7277070 -8.8604651 -8.6956644
#&gt;  [5,] -9.2850099 -9.2739451 -9.3861178 -9.3499053
#&gt;  [6,] -9.4332688 -9.4056957 -9.5224228 -9.3860082
#&gt;  [7,] -8.8436259 -8.7805039 -8.8387538 -8.8165714
#&gt;  [8,] -8.0137156 -7.8742692 -7.9793882 -7.9093547
#&gt;  [9,] -7.0667306 -6.9256836 -7.0662254 -7.0338761
#&gt; [10,] -6.3361159 -6.1078432 -6.1476379 -5.9594203
#&gt; [11,] -7.2327762 -7.1106202 -7.1428344 -7.0679743
#&gt; [12,] -7.1783911 -7.1857184 -7.2781160 -7.1168895
#&gt; [13,] -7.3072336 -7.4045517 -7.3214001 -7.2762453
#&gt; [14,] -7.7237661 -7.9678614 -7.8278191 -7.8630655
#&gt; [15,] -8.0260899 -7.7861723 -7.7680711 -7.6407317
#&gt; [16,] -7.6599578 -7.6492318 -7.4857448 -7.5853142
#&gt; [17,] -6.2678129 -6.2540718 -6.5835519 -6.2835123
#&gt; [18,] -5.1492752 -5.1052491 -5.3636774 -5.1214401
#&gt; [19,] -5.1169781 -5.2331852 -5.1571689 -5.2296168
#&gt; [20,] -5.1188697 -5.0656428 -5.2359507 -4.9823142
#&gt; [21,] -6.8360709 -6.7767985 -6.8984850 -6.8260180
#&gt; [22,] -6.7059048 -6.7583198 -6.7523369 -6.6220389
#&gt; [23,] -6.6543126 -6.6947408 -6.6667941 -6.6454827
#&gt; [24,] -6.8994780 -7.0075680 -7.1348214 -6.8817455
#&gt; [25,] -6.6201246 -6.6052702 -6.8830227 -6.5915023
#&gt; [26,] -5.4718692 -5.5042270 -5.8544191 -5.4721381
#&gt; [27,] -5.0319616 -4.6027772 -4.6166645 -4.5438811
#&gt; [28,] -3.0095519 -3.0965070 -3.1366145 -2.6405439
#&gt; [29,] -4.1795082 -3.9618028 -4.1085599 -4.0979608
#&gt; [30,] -4.1144885 -3.9972195 -4.1890729 -3.9932335
#&gt; [31,] -6.7144089 -6.6675042 -6.7016896 -6.6686872
#&gt; [32,] -6.2911630 -6.2085773 -6.2422090 -6.2034583
#&gt; [33,] -5.9984344 -6.0207954 -6.0056217 -5.9992131
#&gt; [34,] -6.0799765 -6.1384429 -6.1105375 -6.1631097
#&gt; [35,] -5.2566102 -5.1811086 -5.4437030 -5.0933216
#&gt; [36,] -3.8446080 -3.6657192 -4.0968299 -3.8082778
#&gt; [37,] -2.8908112 -2.8176800 -3.1197047 -2.8179729
#&gt; [38,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [39,] -2.6833869 -2.8564858 -2.6509871 -2.7382076
#&gt; [40,] -3.0557201 -3.4033170 -3.5641252 -2.9979827
#&gt; [41,] -6.0392388 -6.0530008 -6.1307364 -5.9969345
#&gt; [42,] -5.7489873 -5.7039714 -5.6803071 -5.6969886
#&gt; [43,] -5.4303474 -5.3322923 -5.3915390 -5.3457025
#&gt; [44,] -5.2705331 -5.0547948 -5.3111927 -5.1458576
#&gt; [45,] -3.9604626 -3.7509837 -4.2468855 -3.8436897
#&gt; [46,] -2.5829062 -2.6335946 -2.5429944 -2.5462789
#&gt; [47,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [48,] -0.5511479 -1.0331700 -0.7118138 -0.4685590
#&gt; [49,] -0.9999500 -2.0544279 -1.4758102 -1.2776091
#&gt; [50,] -1.9995108 -2.1887182 -2.4209024 -2.0971717
#&gt; [51,] -5.6110173 -5.4818393 -5.5469933 -5.4879716
#&gt; [52,] -5.2238107 -5.1940632 -5.2148020 -5.1554241
#&gt; [53,] -4.8064032 -4.7220770 -4.7760653 -4.6737740
#&gt; [54,] -4.2782548 -4.2084575 -4.4848072 -4.2203542
#&gt; [55,] -2.9560584 -2.8216657 -3.3374213 -2.9286140
#&gt; [56,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [57,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [58,] -0.1000000 -0.2298919 -0.2900551 -0.1271000
#&gt; [59,] -0.9448314 -1.0861478 -0.9458948 -1.0236060
#&gt; [60,] -1.4412687 -1.4143298 -1.4682704 -1.4189421
#&gt; [61,] -5.1438360 -5.1429484 -5.1950279 -5.2707878
#&gt; [62,] -4.8642525 -4.6874612 -4.8327971 -4.8367223
#&gt; [63,] -4.1319959 -4.0865411 -4.1311934 -4.2273441
#&gt; [64,] -3.4155808 -3.3626348 -3.4251618 -3.4695346
#&gt; [65,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [66,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [67,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [68,]  0.0000000  0.0000000  0.0000000  0.0000000
#&gt; [69,] -0.3439000 -0.4848131 -0.4745144 -0.3871031
#&gt; [70,] -0.8791022 -1.0070868 -1.0641967 -1.0169789
#&gt; 
#&gt; $Q2
#&gt; NULL
#&gt; 
#&gt; $steps
#&gt;   [1]  631 1965  431  604  198  546  306  191  176  269  240  100  181  320  100
#&gt;  [16]   97  285  190   75  109  190   65   71   87  156   95  156   71  133  127
#&gt;  [31]  219   43  178   57   38   60   74  143   34  174   28   93  160   85   58
#&gt;  [46]   53  204   44   41   59  147   65   54  145   34   32   43   89  134   36
#&gt;  [61]   80   64   99   74   60  112   75   49   23  104   65   41   29  190   59
#&gt;  [76]   50   95   44   34   78  102   25   63   35   92   36  142   86   28   72
#&gt;  [91]   76   48   69   57   40   31   41   41  140   27
#&gt; </div><div class='input'>
<span class='co'># Decay epsilon over time. Each 10 episodes epsilon will be halfed.</span>
<span class='no'>decayEpsilon</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>epsilon</span>, <span class='no'>i</span>) {
  <span class='kw'>if</span> (<span class='no'>i</span> <span class='kw'>%%</span> <span class='fl'>10</span> <span class='kw'>==</span> <span class='fl'>0</span>) {
    <span class='no'>epsilon</span> <span class='kw'>=</span> <span class='no'>epsilon</span> * <span class='fl'>0.5</span>
  }
  <span class='no'>epsilon</span>
}

<span class='fu'>expectedSarsa</span>(<span class='no'>env</span>, <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>updateEpsilon</span> <span class='kw'>=</span> <span class='no'>decayEpsilon</span>)</div><div class='output co'>#&gt; <span class='message'>Episode 1 finished after 557 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 2 finished after 955 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 3 finished after 1166 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 4 finished after 757 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 5 finished after 765 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 6 finished after 270 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 7 finished after 357 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 8 finished after 340 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 9 finished after 836 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 10 finished after 195 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 11 finished after 173 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 12 finished after 292 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 13 finished after 415 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 14 finished after 227 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 15 finished after 67 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 16 finished after 943 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 17 finished after 72 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 18 finished after 316 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 19 finished after 199 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 20 finished after 204 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 21 finished after 238 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 22 finished after 62 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 23 finished after 171 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 24 finished after 310 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 25 finished after 41 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 26 finished after 232 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 27 finished after 85 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 28 finished after 380 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 29 finished after 47 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 30 finished after 58 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 31 finished after 51 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 32 finished after 142 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 33 finished after 60 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 34 finished after 34 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 35 finished after 59 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 36 finished after 384 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 37 finished after 107 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 38 finished after 102 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 39 finished after 77 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 40 finished after 101 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 41 finished after 329 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 42 finished after 41 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 43 finished after 110 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 44 finished after 73 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 45 finished after 78 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 46 finished after 92 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 47 finished after 71 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 48 finished after 162 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 49 finished after 138 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 50 finished after 88 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 51 finished after 165 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 52 finished after 30 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 53 finished after 243 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 54 finished after 226 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 55 finished after 80 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 56 finished after 90 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 57 finished after 153 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 58 finished after 62 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 59 finished after 87 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 60 finished after 135 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 61 finished after 56 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 62 finished after 139 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 63 finished after 68 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 64 finished after 303 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 65 finished after 126 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 66 finished after 158 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 67 finished after 68 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 68 finished after 161 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 69 finished after 53 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 70 finished after 44 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 71 finished after 146 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 72 finished after 86 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 73 finished after 75 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 74 finished after 164 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 75 finished after 121 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 76 finished after 120 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 77 finished after 110 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 78 finished after 44 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 79 finished after 49 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 80 finished after 82 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 81 finished after 209 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 82 finished after 32 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 83 finished after 104 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 84 finished after 91 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 85 finished after 223 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 86 finished after 115 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 87 finished after 149 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 88 finished after 204 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 89 finished after 94 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 90 finished after 148 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 91 finished after 148 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 92 finished after 235 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 93 finished after 95 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 94 finished after 150 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 95 finished after 173 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 96 finished after 248 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 97 finished after 129 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 98 finished after 100 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 99 finished after 201 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 100 finished after 97 time steps.</span></div><div class='output co'>#&gt; $Q1
#&gt;              [,1]       [,2]       [,3]        [,4]
#&gt;  [1,]  -9.5697794  -9.782158  -9.605207  -9.6419234
#&gt;  [2,]  -9.9526893 -10.018601 -10.119579  -9.9714616
#&gt;  [3,] -10.5103775 -11.784353 -10.880504 -10.4785584
#&gt;  [4,] -11.4818933 -12.764855 -11.512055 -11.6886589
#&gt;  [5,] -12.4547021 -12.939422 -12.527340 -12.4813506
#&gt;  [6,] -13.0347483 -13.079019 -13.241033 -13.0973980
#&gt;  [7,] -13.1401943 -12.606339 -12.736974 -12.6294207
#&gt;  [8,] -12.9597774 -11.552660 -11.925458 -12.2022830
#&gt;  [9,] -12.4672001 -10.295267 -11.085001 -10.8595412
#&gt; [10,] -11.1993854  -9.909509 -10.059169  -8.9975100
#&gt; [11,]  -9.4676452  -9.357758  -9.412311  -9.3937603
#&gt; [12,]  -9.4644182  -9.541196  -9.606644  -9.4423509
#&gt; [13,]  -9.6778064 -10.567116 -10.180040  -9.5863043
#&gt; [14,] -10.6079082 -10.924477 -11.030685 -10.6237616
#&gt; [15,] -10.2803839 -11.772866 -11.191763 -10.1870589
#&gt; [16,] -10.4178484 -11.616791 -10.502838 -10.3187408
#&gt; [17,]  -8.8913960  -8.649783  -9.318747  -8.4730244
#&gt; [18,]  -8.9139307  -8.065505  -8.803895  -8.6697748
#&gt; [19,] -10.1826736  -9.465586  -9.500475  -9.4183521
#&gt; [20,]  -9.8020276  -8.244600  -9.919764  -7.3709218
#&gt; [21,]  -9.0717295  -9.046678  -9.180413  -9.0831513
#&gt; [22,]  -8.8086199  -8.859121  -9.172047  -8.8342309
#&gt; [23,]  -8.8750012  -9.235965  -9.496096  -8.6952447
#&gt; [24,]  -9.5814689  -9.803439  -9.927301  -9.6356691
#&gt; [25,]  -9.2617507  -9.017606  -8.954377  -9.0014594
#&gt; [26,]  -7.7571849  -7.589635  -8.383017  -7.4446383
#&gt; [27,]  -7.9366171  -5.830675  -6.345620  -6.2997594
#&gt; [28,]  -5.7443704  -6.360523  -5.609723  -5.2351887
#&gt; [29,]  -7.3255239  -7.303254  -9.183153  -7.3320006
#&gt; [30,]  -7.1536782  -7.026491  -8.723526  -5.7619503
#&gt; [31,]  -8.7088681  -8.514246  -9.324936  -8.4853466
#&gt; [32,]  -8.5616032  -8.171508  -8.194653  -8.2048180
#&gt; [33,]  -7.8712798  -7.916059  -8.992667  -7.9072128
#&gt; [34,]  -8.4367700  -8.018796  -9.493055  -7.9417329
#&gt; [35,]  -7.5705602  -7.285788  -8.636144  -7.1624213
#&gt; [36,]  -5.7861151  -4.821841  -7.126910  -5.1426776
#&gt; [37,]  -4.3152566  -3.592356  -4.129950  -3.8251559
#&gt; [38,]   0.0000000   0.000000   0.000000   0.0000000
#&gt; [39,]  -4.9295904  -4.965711  -5.484169  -4.8325696
#&gt; [40,]  -5.1444588  -5.298200  -6.925514  -4.2840602
#&gt; [41,]  -7.7534880  -7.712469  -8.247840  -7.8502093
#&gt; [42,]  -7.6520250  -7.582371  -7.769884  -7.5460723
#&gt; [43,]  -7.3029541  -7.376235  -7.500715  -7.2880276
#&gt; [44,]  -7.4248249  -7.193765  -8.832682  -7.0844335
#&gt; [45,]  -6.6813478  -5.205812  -6.507668  -5.2740561
#&gt; [46,]  -4.4510462  -3.192386  -3.712365  -3.0971892
#&gt; [47,]   0.0000000   0.000000   0.000000   0.0000000
#&gt; [48,]  -1.5021072  -1.467566  -2.095381  -0.7941089
#&gt; [49,]  -0.9998710  -4.129212  -6.497720  -2.3565107
#&gt; [50,]  -3.1253227  -3.656807  -4.705036  -3.1041855
#&gt; [51,]  -7.4570316  -7.451468  -7.440952  -7.4207689
#&gt; [52,]  -7.5062539  -7.102669  -7.334561  -7.0036508
#&gt; [53,]  -6.9677277  -6.550299  -6.958248  -6.5672050
#&gt; [54,]  -6.1415643  -5.921716  -6.840662  -5.8752426
#&gt; [55,]  -6.0287749  -3.479440  -5.493783  -3.6765431
#&gt; [56,]   0.0000000   0.000000   0.000000   0.0000000
#&gt; [57,]   0.0000000   0.000000   0.000000   0.0000000
#&gt; [58,]  -0.6181934  -1.020427  -0.900078  -0.3023058
#&gt; [59,]  -1.6461254  -2.065032  -2.320850  -1.6652092
#&gt; [60,]  -2.2804626  -2.475392  -2.536286  -2.3338327
#&gt; [61,]  -7.0132334  -7.016206  -7.175261  -7.2951754
#&gt; [62,]  -6.5810419  -6.515776  -7.172524  -6.8577491
#&gt; [63,]  -6.3690161  -5.717163  -6.474907  -6.0565062
#&gt; [64,]  -5.7782127  -4.534721  -6.296997  -5.1660833
#&gt; [65,]   0.0000000   0.000000   0.000000   0.0000000
#&gt; [66,]   0.0000000   0.000000   0.000000   0.0000000
#&gt; [67,]   0.0000000   0.000000   0.000000   0.0000000
#&gt; [68,]   0.0000000   0.000000   0.000000   0.0000000
#&gt; [69,]  -0.8339855  -1.259269  -1.087360  -1.2900083
#&gt; [70,]  -1.6334568  -1.609699  -1.792616  -1.8676302
#&gt; 
#&gt; $Q2
#&gt; NULL
#&gt; 
#&gt; $steps
#&gt;   [1]  557  955 1166  757  765  270  357  340  836  195  173  292  415  227   67
#&gt;  [16]  943   72  316  199  204  238   62  171  310   41  232   85  380   47   58
#&gt;  [31]   51  142   60   34   59  384  107  102   77  101  329   41  110   73   78
#&gt;  [46]   92   71  162  138   88  165   30  243  226   80   90  153   62   87  135
#&gt;  [61]   56  139   68  303  126  158   68  161   53   44  146   86   75  164  121
#&gt;  [76]  120  110   44   49   82  209   32  104   91  223  115  149  204   94  148
#&gt;  [91]  148  235   95  150  173  248  129  100  201   97
#&gt; </div><div class='input'>
<span class='co'># Solve the Mountain Car problem using linear function approximation</span>
<span class='no'>m</span> <span class='kw'>=</span> <span class='fu'><a href='MountainCar.html'>MountainCar</a></span>()

<span class='co'># Define preprocessing function (we use grid tiling)</span>
<span class='no'>n.tilings</span> <span class='kw'>=</span> <span class='fl'>8</span>
<span class='no'>max.size</span> <span class='kw'>=</span> <span class='fl'>4096</span>
<span class='no'>iht</span> <span class='kw'>=</span> <span class='fu'><a href='tilecoding.html'>IHT</a></span>(<span class='no'>max.size</span>)

<span class='no'>position.max</span> <span class='kw'>=</span> <span class='no'>m</span>$<span class='no'>state.space.bounds</span><span class='kw'>[[</span><span class='fl'>1</span>]][<span class='fl'>2</span>]
<span class='no'>position.min</span> <span class='kw'>=</span> <span class='no'>m</span>$<span class='no'>state.space.bounds</span><span class='kw'>[[</span><span class='fl'>1</span>]][<span class='fl'>1</span>]
<span class='no'>velocity.max</span> <span class='kw'>=</span> <span class='no'>m</span>$<span class='no'>state.space.bounds</span><span class='kw'>[[</span><span class='fl'>2</span>]][<span class='fl'>2</span>]
<span class='no'>velocity.min</span> <span class='kw'>=</span> <span class='no'>m</span>$<span class='no'>state.space.bounds</span><span class='kw'>[[</span><span class='fl'>2</span>]][<span class='fl'>1</span>]
<span class='no'>position.scale</span> <span class='kw'>=</span> <span class='no'>n.tilings</span> / (<span class='no'>position.max</span> - <span class='no'>position.min</span>)
<span class='no'>velocity.scale</span> <span class='kw'>=</span> <span class='no'>n.tilings</span> / (<span class='no'>velocity.max</span> - <span class='no'>velocity.min</span>)

<span class='co'># Scale state first, then get active tiles and return n hot vector</span>
<span class='no'>gridTiling</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>state</span>) {
  <span class='no'>state</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='no'>position.scale</span> * <span class='no'>state</span>[<span class='fl'>1</span>], <span class='no'>velocity.scale</span> * <span class='no'>state</span>[<span class='fl'>2</span>])
  <span class='no'>active.tiles</span> <span class='kw'>=</span> <span class='fu'><a href='tilecoding.html'>tiles</a></span>(<span class='no'>iht</span>, <span class='fl'>8</span>, <span class='no'>state</span>)
  <span class='fu'><a href='makeNHot.html'>makeNHot</a></span>(<span class='no'>active.tiles</span>, <span class='no'>max.size</span>, <span class='kw'>out</span> <span class='kw'>=</span> <span class='st'>"vector"</span>)
}

<span class='fu'>set.seed</span>(<span class='fl'>123</span>)
<span class='fu'>sarsa</span>(<span class='no'>m</span>, <span class='kw'>fun.approx</span> <span class='kw'>=</span> <span class='st'>"linear"</span>, <span class='kw'>preprocessState</span> <span class='kw'>=</span> <span class='no'>gridTiling</span>)</div><div class='output co'>#&gt; <span class='message'>Episode 1 finished after 840 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 2 finished after 784 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 3 finished after 684 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 4 finished after 694 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 5 finished after 318 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 6 finished after 475 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 7 finished after 270 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 8 finished after 274 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 9 finished after 235 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 10 finished after 199 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 11 finished after 276 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 12 finished after 160 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 13 finished after 213 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 14 finished after 304 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 15 finished after 216 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 16 finished after 235 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 17 finished after 224 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 18 finished after 180 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 19 finished after 153 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 20 finished after 222 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 21 finished after 154 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 22 finished after 263 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 23 finished after 225 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 24 finished after 174 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 25 finished after 248 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 26 finished after 159 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 27 finished after 151 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 28 finished after 150 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 29 finished after 231 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 30 finished after 153 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 31 finished after 180 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 32 finished after 199 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 33 finished after 236 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 34 finished after 230 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 35 finished after 153 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 36 finished after 228 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 37 finished after 210 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 38 finished after 196 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 39 finished after 196 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 40 finished after 194 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 41 finished after 229 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 42 finished after 219 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 43 finished after 142 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 44 finished after 233 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 45 finished after 193 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 46 finished after 183 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 47 finished after 225 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 48 finished after 205 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 49 finished after 210 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 50 finished after 236 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 51 finished after 199 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 52 finished after 194 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 53 finished after 175 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 54 finished after 160 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 55 finished after 231 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 56 finished after 258 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 57 finished after 440 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 58 finished after 272 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 59 finished after 194 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 60 finished after 241 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 61 finished after 272 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 62 finished after 204 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 63 finished after 199 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 64 finished after 265 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 65 finished after 295 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 66 finished after 558 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 67 finished after 442 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 68 finished after 236 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 69 finished after 148 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 70 finished after 349 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 71 finished after 165 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 72 finished after 156 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 73 finished after 407 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 74 finished after 632 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 75 finished after 202 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 76 finished after 210 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 77 finished after 261 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 78 finished after 280 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 79 finished after 231 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 80 finished after 764 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 81 finished after 283 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 82 finished after 152 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 83 finished after 353 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 84 finished after 208 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 85 finished after 227 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 86 finished after 542 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 87 finished after 161 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 88 finished after 286 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 89 finished after 420 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 90 finished after 244 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 91 finished after 254 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 92 finished after 1814 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 93 finished after 308 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 94 finished after 242 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 95 finished after 382 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 96 finished after 194 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 97 finished after 441 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 98 finished after 1352 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 99 finished after 350 time steps.</span></div><div class='output co'>#&gt; <span class='message'>Episode 100 finished after 489 time steps.</span></div><div class='output co'>#&gt; $Q1
#&gt;                  [,1]         [,2]         [,3]
#&gt;    [1,] -33.181231354 -30.15487871 -28.73442791
#&gt;    [2,] -31.351183598 -30.71303102 -24.70990187
#&gt;    [3,] -25.012464680 -32.94051926 -35.34666568
#&gt;    [4,] -31.161287620 -30.19537909 -27.06570056
#&gt;    [5,] -19.742829526 -25.36280647 -28.25269269
#&gt;    [6,] -25.320767704 -33.58433972 -37.92035795
#&gt;    [7,] -29.519074674 -20.50769383 -14.74864782
#&gt;    [8,] -31.143373584 -38.26918945 -29.31168400
#&gt;    [9,]  -8.532371583 -25.39055417 -16.69892281
#&gt;   [10,]  -8.441080819 -23.91353854 -17.30526308
#&gt;   [11,] -21.169553495 -18.02768133 -13.75970061
#&gt;   [12,] -27.498026818 -38.84426008 -26.62132440
#&gt;   [13,] -23.217624141 -43.07185143 -40.65306170
#&gt;   [14,] -29.114694647 -23.27367123 -27.07121647
#&gt;   [15,] -29.278333102 -28.04567740 -11.03890092
#&gt;   [16,] -22.842209081 -22.45037698 -19.72653522
#&gt;   [17,] -20.899502375 -19.67573455 -15.29221181
#&gt;   [18,] -25.378671129 -17.96275833  -9.61420095
#&gt;   [19,] -20.203465880 -14.42769352 -15.51592584
#&gt;   [20,] -16.267457004 -25.78484133 -27.24900455
#&gt;   [21,]  -0.439863653 -11.96724973 -22.55752163
#&gt;   [22,] -19.437955912 -28.82902337 -31.42088177
#&gt;   [23,] -19.561684442 -35.30226240 -21.97841322
#&gt;   [24,] -15.194327808 -19.97226788 -23.98692089
#&gt;   [25,] -22.307279772 -20.79781662 -25.89438629
#&gt;   [26,] -15.144556387 -21.31787117 -23.79014226
#&gt;   [27,]  -7.362461928 -24.91533169 -25.25248625
#&gt;   [28,] -24.477216473 -10.95299893 -19.18169068
#&gt;   [29,] -10.302892231 -17.91351992 -19.24472727
#&gt;   [30,] -24.092071865 -17.09786676 -17.30523410
#&gt;   [31,] -18.146914061 -14.49917930 -15.57164036
#&gt;   [32,]  -6.709315949 -20.37694411 -10.60322761
#&gt;   [33,]  -5.693308104 -20.31024806 -26.88686783
#&gt;   [34,]  -3.100611878 -27.19690602 -21.12895201
#&gt;   [35,] -30.730766816 -17.23900500 -25.69361308
#&gt;   [36,] -28.077139143 -23.23330202 -23.59992682
#&gt;   [37,] -23.541305298 -27.12245043 -19.61646950
#&gt;   [38,]  -7.734584852 -24.50712666 -13.53170751
#&gt;   [39,] -21.721194890 -22.01782286 -27.87153740
#&gt;   [40,] -21.276706285 -24.65407945 -12.39815065
#&gt;   [41,] -37.424211907 -23.40336578 -20.40837451
#&gt;   [42,] -22.043485191 -14.88547917 -26.57236266
#&gt;   [43,] -14.640270113 -18.98724224 -20.04377592
#&gt;   [44,] -26.078703105 -21.23349775 -16.56034321
#&gt;   [45,] -18.001617374 -17.13427468 -22.90862382
#&gt;   [46,] -21.167155213 -19.34662082 -17.06933915
#&gt;   [47,] -31.415300537 -11.01707364 -26.08966716
#&gt;   [48,] -16.034889744  -6.49564285 -31.27597544
#&gt;   [49,] -22.102483876 -16.08545732 -10.61480964
#&gt;   [50,] -17.615550275 -21.09868427 -14.45860518
#&gt;   [51,] -15.976326716 -13.25969588 -10.03341023
#&gt;   [52,] -16.299711323 -19.82787494 -13.48882414
#&gt;   [53,] -13.573030003 -13.10038046  -6.46608050
#&gt;   [54,] -18.106009376 -14.07754979 -21.20699924
#&gt;   [55,] -19.937829698 -19.65561842  -4.39934451
#&gt;   [56,] -16.561360463 -14.90747842 -13.92406904
#&gt;   [57,] -17.549350672 -13.40087510  -9.02509809
#&gt;   [58,] -17.702696971  -7.66033868 -11.09349404
#&gt;   [59,] -16.070985926 -11.50540668 -17.93223845
#&gt;   [60,] -19.452347212 -17.57758755  -4.87646046
#&gt;   [61,] -18.292822324 -16.09502963 -18.50607909
#&gt;   [62,] -14.010666183 -10.07111490 -12.05512513
#&gt;   [63,] -14.758104745 -15.36856870 -18.51203988
#&gt;   [64,] -12.289370948 -12.48350046 -16.70608935
#&gt;   [65,]  -8.970739275 -16.07536964 -15.57669683
#&gt;   [66,] -13.527156552 -15.57467265 -25.14146633
#&gt;   [67,]  -0.454196120 -12.14071588 -13.04735965
#&gt;   [68,]  -3.908777989 -20.03467412 -25.10455335
#&gt;   [69,] -11.499586843  -9.15476869 -18.47032482
#&gt;   [70,] -19.760511229 -12.75098281 -15.72146831
#&gt;   [71,] -17.583831245 -11.68817380 -13.75290748
#&gt;   [72,] -16.048657982 -12.48567862 -16.46559083
#&gt;   [73,]  -8.193545074 -16.96735205 -15.82110216
#&gt;   [74,] -17.453039858 -17.40903372 -17.57884649
#&gt;   [75,] -19.109216947  -9.53309428 -20.51269307
#&gt;   [76,] -13.757479263 -18.16811114 -13.70748010
#&gt;   [77,] -13.273284629 -11.43392751 -12.37731339
#&gt;   [78,] -10.173468791 -17.72176469 -11.43175025
#&gt;   [79,] -17.198639281 -17.36232728  -8.03048004
#&gt;   [80,] -12.016430980 -10.89569052 -16.21300084
#&gt;   [81,] -12.303460834 -17.85411719 -13.05001239
#&gt;   [82,] -16.999938257 -18.96112272 -17.84747571
#&gt;   [83,] -12.754015062  -9.99535583 -16.24219322
#&gt;   [84,] -13.027444244 -20.40671861 -18.75821571
#&gt;   [85,] -11.751483694 -10.88304952 -13.31371541
#&gt;   [86,] -11.086249122 -14.92888450 -14.60693988
#&gt;   [87,]  -9.846740453 -11.35755736  -8.20881822
#&gt;   [88,] -13.947012715 -11.72802109  -5.87230885
#&gt;   [89,] -15.296733270 -12.82220645 -14.23647749
#&gt;   [90,] -18.555090425 -16.57471520 -17.68491851
#&gt;   [91,] -17.391950929 -14.22723022 -14.23006695
#&gt;   [92,] -18.734121921 -21.84100779 -13.80833811
#&gt;   [93,] -17.308937888 -15.31138001 -17.56696497
#&gt;   [94,] -14.050021530 -13.37424437 -14.63682907
#&gt;   [95,] -13.732560487 -10.73881760 -17.30842164
#&gt;   [96,] -15.274046689 -17.86753486 -14.10453200
#&gt;   [97,]  -8.661110385 -11.90308050 -22.83434190
#&gt;   [98,] -11.492417973 -11.72835321 -18.45575170
#&gt;   [99,] -13.619514767 -15.86391089 -10.53112139
#&gt;  [100,] -14.725038194 -13.51306985 -18.94025819
#&gt;  [101,] -11.768555969 -16.66812584 -19.18581678
#&gt;  [102,] -14.818344687 -12.86595008 -15.11040799
#&gt;  [103,] -14.965398053 -16.22386281 -15.75021635
#&gt;  [104,]  -7.809709198 -14.13808098 -16.31087856
#&gt;  [105,]  -9.718414163 -11.70646602 -14.74101438
#&gt;  [106,] -15.916684473 -14.05360673 -14.30684271
#&gt;  [107,] -13.591455784 -15.23122857 -15.46598605
#&gt;  [108,]  -5.281236223 -11.32952019 -18.69520723
#&gt;  [109,]  -6.604904308  -8.18324409 -12.63251353
#&gt;  [110,]  -9.104977125 -11.02172632 -13.59988384
#&gt;  [111,] -15.978678857 -12.83779492 -12.26499749
#&gt;  [112,] -10.506540276  -9.39785248 -11.52460280
#&gt;  [113,] -17.510439652 -11.48305595 -11.84625334
#&gt;  [114,] -16.044125010 -11.38843269 -12.68655857
#&gt;  [115,] -18.595574345 -12.81437773 -15.61896343
#&gt;  [116,] -16.451705313 -20.99613594 -15.37377219
#&gt;  [117,] -15.365649587 -14.89800238 -15.19461163
#&gt;  [118,] -16.409005061 -15.29190834 -17.99815424
#&gt;  [119,] -10.314779857 -10.38104689 -17.58637941
#&gt;  [120,] -10.036664597 -10.04176309 -14.02709937
#&gt;  [121,] -11.887808192  -8.75018218 -13.24214490
#&gt;  [122,] -18.353305242 -11.56298605 -16.65167322
#&gt;  [123,] -12.487371063 -19.77231413 -17.16809348
#&gt;  [124,] -24.733079424 -16.69377410 -21.19889056
#&gt;  [125,]  -9.837430058 -16.32879462 -19.56139650
#&gt;  [126,] -17.382302544 -20.19480166 -18.02860265
#&gt;  [127,]  -8.772637500 -13.79282206  -9.88726205
#&gt;  [128,] -10.204676841 -12.37170143 -14.57500404
#&gt;  [129,]  -9.800214426 -11.98611746 -12.74116150
#&gt;  [130,]  -7.801100658 -14.24655133 -11.84443286
#&gt;  [131,]  -6.860673674 -11.01676462 -12.44802737
#&gt;  [132,] -14.856805534 -12.19109778 -10.19171662
#&gt;  [133,] -18.721305890 -13.67118203  -9.75561445
#&gt;  [134,]  -7.109235001  -9.98110595  -9.79148479
#&gt;  [135,]  -7.977748240 -11.37578600  -9.11958535
#&gt;  [136,] -13.247884452 -16.21753342  -7.03332681
#&gt;  [137,] -12.098645599 -14.91360157 -11.54771532
#&gt;  [138,] -16.471435428  -7.09719560 -13.12814843
#&gt;  [139,] -15.084418697 -15.72240985 -12.51935994
#&gt;  [140,] -11.346671323 -10.96099285 -10.19969761
#&gt;  [141,] -14.786742777 -11.68396468 -12.90213031
#&gt;  [142,] -14.318189759 -10.94122229 -15.85250942
#&gt;  [143,] -15.201582075 -14.97003205 -11.27340174
#&gt;  [144,] -10.778072870 -13.85190582 -11.54158155
#&gt;  [145,] -14.433981829 -10.73745352 -18.73877095
#&gt;  [146,] -14.047446318 -14.96521354 -17.09838340
#&gt;  [147,]  -8.851675753 -12.33153896 -12.10751965
#&gt;  [148,] -18.480958302 -13.53857773 -11.57263359
#&gt;  [149,] -14.896180694 -12.42398197 -13.10247541
#&gt;  [150,] -16.320774728 -13.72972906 -13.41252191
#&gt;  [151,] -14.773674233 -12.10541217  -8.14367096
#&gt;  [152,]  -9.587983699 -10.56293659 -11.12083959
#&gt;  [153,] -10.233538552 -12.65512658 -11.88358098
#&gt;  [154,] -12.177990528  -7.69771086 -10.61351271
#&gt;  [155,] -13.191851790 -11.06704589 -11.33753167
#&gt;  [156,] -15.971069012 -14.32111749  -5.45606875
#&gt;  [157,] -16.489069881 -16.98810748  -9.04812426
#&gt;  [158,] -14.448052133 -11.36308354 -13.06468108
#&gt;  [159,] -11.058755014 -10.75602375 -15.32277937
#&gt;  [160,] -14.601873769 -15.57728312 -12.32447919
#&gt;  [161,] -15.646812581 -18.39243191 -13.86435771
#&gt;  [162,] -14.404332762 -12.49407794 -14.86203778
#&gt;  [163,] -12.950067751  -9.40183427 -13.89488858
#&gt;  [164,] -12.055621141  -9.44979624 -16.83580688
#&gt;  [165,] -14.936904845 -16.95197612  -7.14162961
#&gt;  [166,] -15.956594584 -13.99599467 -10.36436912
#&gt;  [167,] -14.466006244 -14.29253221  -8.80319796
#&gt;  [168,] -13.988419174 -16.21781577 -18.31542116
#&gt;  [169,] -15.801326828 -15.61024763 -13.06002734
#&gt;  [170,] -13.585772094 -12.54750684 -12.75097355
#&gt;  [171,] -12.096831819 -14.02770639 -13.19012081
#&gt;  [172,] -13.522098015 -10.76632511 -19.55629208
#&gt;  [173,]  -9.962283488 -10.68387214 -10.97197698
#&gt;  [174,] -10.620094915 -11.62439873 -10.47261697
#&gt;  [175,] -16.157142088 -13.62090463 -13.86569017
#&gt;  [176,] -13.545463000 -11.46212870 -15.16323186
#&gt;  [177,] -12.495115775 -13.00433407 -10.17260583
#&gt;  [178,] -11.923417996 -11.48340608 -12.29319515
#&gt;  [179,] -12.007070391 -13.55419191 -13.71326873
#&gt;  [180,] -10.059610193 -14.52952808 -12.17964727
#&gt;  [181,]  -7.752075876 -14.11761528 -12.61937866
#&gt;  [182,]  -6.555660849 -12.75118667 -10.51266062
#&gt;  [183,]  -7.728666375 -14.45216428 -11.57082078
#&gt;  [184,] -17.960249204 -14.22836664 -16.28393603
#&gt;  [185,] -11.868888206 -13.19573687 -12.35118780
#&gt;  [186,] -13.589936973 -16.53264205 -14.52032774
#&gt;  [187,] -10.840675434 -12.86737731 -14.64023797
#&gt;  [188,] -17.218578801 -13.73721977 -13.07401146
#&gt;  [189,]  -9.235164868 -14.19709359 -11.99000322
#&gt;  [190,]  -9.816320274 -11.04967464 -11.36079792
#&gt;  [191,] -13.796321619  -7.89158886 -12.07937502
#&gt;  [192,] -11.398778483  -8.11767185 -10.81490790
#&gt;  [193,] -12.746043158  -9.92518972 -11.11365563
#&gt;  [194,] -14.995795143 -12.30223071 -10.38611454
#&gt;  [195,]  -8.548693984 -11.14697386 -10.63154806
#&gt;  [196,] -11.819586359 -13.36807403  -8.47721742
#&gt;  [197,] -15.525529682 -12.25830390 -14.60077463
#&gt;  [198,] -13.121649026 -11.74529558 -10.51714979
#&gt;  [199,] -11.446536218 -13.43805814 -12.23698011
#&gt;  [200,] -16.385590316 -11.34093505 -13.41216346
#&gt;  [201,] -17.490465440  -9.42676893 -11.16156105
#&gt;  [202,] -11.527130462  -8.95710907 -12.09236336
#&gt;  [203,] -14.959156202 -13.67134407 -12.45196066
#&gt;  [204,] -14.913069736 -13.41636827 -14.76859804
#&gt;  [205,] -10.804187527 -10.74290720 -13.81163168
#&gt;  [206,] -10.820556161 -13.61543927 -10.14751926
#&gt;  [207,] -14.685012137 -12.33132325 -12.91768005
#&gt;  [208,] -13.120874184 -12.89358280 -16.86285920
#&gt;  [209,]  -9.638323290 -10.75034462 -11.53109301
#&gt;  [210,] -11.543346547 -12.86819657 -17.27069981
#&gt;  [211,] -11.824473690 -12.53393722 -10.17437363
#&gt;  [212,]  -8.895080788 -11.43101704 -14.92151026
#&gt;  [213,] -13.616232973 -11.14389544 -11.11502419
#&gt;  [214,] -16.515757785 -15.18539062 -16.74108257
#&gt;  [215,] -13.482686525 -14.26349144 -12.72952456
#&gt;  [216,] -16.907926772 -12.95636890 -14.01610327
#&gt;  [217,] -13.309622846 -12.46376072  -8.98318933
#&gt;  [218,] -12.449520333 -11.01448972  -7.20325349
#&gt;  [219,] -11.101508035 -12.82774576 -13.17468958
#&gt;  [220,] -16.484005632 -12.58107107  -9.84512730
#&gt;  [221,] -11.440236244  -9.96446494 -14.28731336
#&gt;  [222,] -13.379836455 -13.58549748  -8.34015570
#&gt;  [223,] -10.776855783  -7.89099519 -13.16702747
#&gt;  [224,] -14.683689302 -18.29025814  -8.44778097
#&gt;  [225,]  -9.703031865  -9.64078585  -7.06418798
#&gt;  [226,] -14.068255638 -11.29264468 -12.67778135
#&gt;  [227,] -15.460786438 -11.55674113 -14.39904797
#&gt;  [228,] -14.510135673 -11.91523650  -5.32139294
#&gt;  [229,] -11.988673997  -8.12778392  -4.28716525
#&gt;  [230,] -11.584858305  -9.54253925 -11.82200039
#&gt;  [231,] -11.627306688 -12.45008615 -10.03170346
#&gt;  [232,]  -9.904523665 -12.07756581  -8.06439554
#&gt;  [233,]  -9.297307424 -15.80457272  -4.39343484
#&gt;  [234,]  -8.059829910 -10.56364134  -2.44544983
#&gt;  [235,] -14.250638156 -11.53064214 -10.10177365
#&gt;  [236,]  -9.707520563 -14.30778999  -6.52840528
#&gt;  [237,] -10.450231342 -14.56393686 -22.39332503
#&gt;  [238,] -11.133286222 -11.66600980 -11.01775649
#&gt;  [239,] -11.468871288 -13.30134938 -13.49717194
#&gt;  [240,]  -9.969707905 -11.78556780 -12.76516715
#&gt;  [241,]  -9.688516125 -13.98957338 -14.27860360
#&gt;  [242,]  -8.913863427 -12.34682889 -13.57228785
#&gt;  [243,] -10.391350538 -12.57247431 -11.23512631
#&gt;  [244,]  -6.649153843 -12.14812993 -11.52523952
#&gt;  [245,] -11.015357255 -12.98542489 -12.54792873
#&gt;  [246,] -14.292865394 -12.33009027 -13.10801959
#&gt;  [247,] -13.980489223 -13.05967512 -12.61418671
#&gt;  [248,] -11.036739887 -11.85240706 -13.02380794
#&gt;  [249,]  -8.404612106 -10.76593095 -12.11961706
#&gt;  [250,]  -9.475936552 -10.92531537 -12.59441400
#&gt;  [251,] -12.129543236 -13.24935051 -11.34653743
#&gt;  [252,] -12.329808359 -12.49539878 -12.85011829
#&gt;  [253,] -10.753514225 -12.64531181 -11.82070053
#&gt;  [254,] -12.932548527 -11.30409431 -10.79351982
#&gt;  [255,]  -8.624779262 -11.95274994 -12.22950096
#&gt;  [256,] -11.698354447 -11.41197253 -11.65284554
#&gt;  [257,] -12.543047120 -11.22959191  -9.02920881
#&gt;  [258,] -13.065154607 -11.83213961  -9.79001013
#&gt;  [259,] -11.201958954 -11.37166747  -8.64067715
#&gt;  [260,] -10.052846035 -11.06500240 -12.41068417
#&gt;  [261,] -10.147303944  -8.18930400  -9.92243270
#&gt;  [262,] -11.019190508  -7.51058975  -6.02413721
#&gt;  [263,]  -6.017049249  -8.29500393  -9.11746305
#&gt;  [264,] -12.397088828 -11.18692091 -12.48676290
#&gt;  [265,] -10.146954683  -9.77395433 -10.00321484
#&gt;  [266,] -12.206310633 -12.97285253 -11.67009761
#&gt;  [267,]  -9.681758171  -7.45015812  -9.67754082
#&gt;  [268,] -10.728888015 -11.79644770  -7.90739258
#&gt;  [269,] -12.766731119  -8.19497379 -14.61377542
#&gt;  [270,]  -7.908814055  -5.93128845  -7.81420067
#&gt;  [271,]  -9.768891451  -7.67544629  -5.87336619
#&gt;  [272,]  -2.648161156  -4.72437516  -7.19746813
#&gt;  [273,]  -8.185320069 -12.20917711  -4.15903036
#&gt;  [274,]  -6.939924563  -7.30257392  -8.16301384
#&gt;  [275,]   0.066932316  -4.50413714  -4.97096290
#&gt;  [276,]  -9.209061750  -7.43608502  -9.10261630
#&gt;  [277,]  -6.722614219  -9.13809597 -14.31081755
#&gt;  [278,] -10.127483990  -7.12156937  -9.21981035
#&gt;  [279,]  -7.209981310  -9.50883054  -4.31202950
#&gt;  [280,]  -2.479693822  -3.27313194 -11.85271742
#&gt;  [281,]  -6.098629257  -6.07889376  -5.74208714
#&gt;  [282,] -10.464794445  -8.24443863 -10.68483568
#&gt;  [283,]  -9.391971039  -9.17651175 -13.57790172
#&gt;  [284,]  -7.839302976  -8.23854017  -9.42992316
#&gt;  [285,]  -4.266875949  -8.23345890  -9.76838984
#&gt;  [286,]  -9.594277177  -5.48426053  -8.97577815
#&gt;  [287,]  -5.490470680  -6.49781329 -10.79017378
#&gt;  [288,]  -2.756952962  -4.84711597 -10.55820643
#&gt;  [289,]  -5.592339439  -4.49593097 -13.24039878
#&gt;  [290,]  -4.812984582  -3.67712643  -7.75759507
#&gt;  [291,]  -6.061349574  -9.87376419  -8.94724090
#&gt;  [292,]  -9.310631135 -10.61809001 -13.85957725
#&gt;  [293,]  -9.968169119  -9.21487233  -9.64506267
#&gt;  [294,]  -3.638413703  -2.83976200  -8.96774597
#&gt;  [295,] -10.900677028  -7.77558219   0.62988498
#&gt;  [296,]  -2.526812887  -3.61538438  -9.19691545
#&gt;  [297,] -13.614656501 -10.00136477 -14.58971269
#&gt;  [298,]  -0.777293806  -0.20030111  -3.29036942
#&gt;  [299,]  -6.965816784  -6.09437529  -3.81738106
#&gt;  [300,]  -4.734184707  -3.34975194  -2.66079790
#&gt;  [301,] -12.188328973  -7.16997719 -13.01853205
#&gt;  [302,]  -7.680514256   0.67938917 -10.63732818
#&gt;  [303,] -10.308215851  -7.21140865  -7.21130040
#&gt;  [304,]  -6.509785184  -3.89231749  -7.21218312
#&gt;  [305,]  -3.307655800  -0.24424301  -4.23001231
#&gt;  [306,]  -7.454459376  -9.02953171  -3.45255842
#&gt;  [307,]  -5.681275368  -3.79810380  -4.00537105
#&gt;  [308,]  -7.489221486  -5.72869117 -10.17254082
#&gt;  [309,]  -7.527310140  -3.96217779  -8.28126963
#&gt;  [310,]  -3.416758624  -1.28011699  -3.27545645
#&gt;  [311,]  -8.729558246  -5.31492461  -5.10867944
#&gt;  [312,]  -4.391235145  -5.84375114  -3.26603951
#&gt;  [313,]  -8.596346710  -8.68735081  -3.08705117
#&gt;  [314,]  -3.451754475   0.18884604  -5.03194036
#&gt;  [315,]  -6.164669637  -2.70010754   3.41710832
#&gt;  [316,]  -0.143207863  -2.48737674   3.43013059
#&gt;  [317,] -14.041253506 -11.47726998  -5.41978154
#&gt;  [318,]  -9.075088496  -7.92470692 -10.04292996
#&gt;  [319,]  -4.629348521  -2.61446501  10.46574749
#&gt;  [320,] -14.195937790 -11.55290577 -13.80039539
#&gt;  [321,]  -8.513126342  -7.85864157 -10.37491074
#&gt;  [322,] -13.214896027 -13.81610256 -16.42065896
#&gt;  [323,]  -5.969170696   0.06211223  -6.43311526
#&gt;  [324,]  -9.456702390 -12.22162040 -16.10264990
#&gt;  [325,]  -9.160587995  -8.18633140  -9.62425427
#&gt;  [326,] -11.327674339 -11.40599329  -9.53417457
#&gt;  [327,]  -6.027273495 -10.34129462  -9.28306874
#&gt;  [328,]  -8.338341426 -10.18096575  -9.57409137
#&gt;  [329,]  -4.157484223  -5.93868324  -7.43190315
#&gt;  [330,]  -7.384511358  -8.13208676  -7.24318347
#&gt;  [331,] -12.393348716 -11.66010566 -12.06696725
#&gt;  [332,] -10.144064115 -11.21490561 -11.42090790
#&gt;  [333,]  -5.480426710  -5.73851757  -5.47714341
#&gt;  [ reached getOption("max.print") -- omitted 3763 rows ]
#&gt; 
#&gt; $Q2
#&gt; NULL
#&gt; 
#&gt; $steps
#&gt;   [1]  840  784  684  694  318  475  270  274  235  199  276  160  213  304  216
#&gt;  [16]  235  224  180  153  222  154  263  225  174  248  159  151  150  231  153
#&gt;  [31]  180  199  236  230  153  228  210  196  196  194  229  219  142  233  193
#&gt;  [46]  183  225  205  210  236  199  194  175  160  231  258  440  272  194  241
#&gt;  [61]  272  204  199  265  295  558  442  236  148  349  165  156  407  632  202
#&gt;  [76]  210  261  280  231  764  283  152  353  208  227  542  161  286  420  244
#&gt;  [91]  254 1814  308  242  382  194  441 1352  350  489
#&gt; </div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># Use a neural network as function approximator</span>
<span class='no'>makeOneHot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>state</span>) {
  <span class='no'>one.hot</span> <span class='kw'>=</span> <span class='fu'>matrix</span>(<span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>70</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>1</span>)
  <span class='no'>one.hot</span>[<span class='fl'>1</span>, <span class='no'>state</span> + <span class='fl'>1</span>] <span class='kw'>=</span> <span class='fl'>1</span>
  <span class='no'>one.hot</span>
}

<span class='co'># Define keras model</span>
<span class='fu'>library</span>(<span class='no'>keras</span>)
<span class='no'>model</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/keras/topics/keras_model_sequential'>keras_model_sequential</a></span>()
<span class='no'>model</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/keras/topics/layer_dense'>layer_dense</a></span>(<span class='kw'>units</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>activation</span> <span class='kw'>=</span> <span class='st'>'linear'</span>, <span class='kw'>input_shape</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>70</span>))

<span class='fu'>qSigma</span>(<span class='no'>env</span>, <span class='kw'>fun.approx</span> <span class='kw'>=</span> <span class='st'>"neural.network"</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>model</span>, <span class='kw'>preprocessState</span> <span class='kw'>=</span> <span class='no'>makeOneHot</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Markus Dumke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
