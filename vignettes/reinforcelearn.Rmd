---
title: "Introduction to reinforcelearn"
output:rmarkdown::html_vignette:
fig_caption: yes
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

This vignette gives a short introduction how to solve reinforcement learning problems with the `reinforcelearn` package.

---

## Set up an environment

```{r}
library(reinforcelearn)
```

First we need to specify the problem, i.e. set up a reinforcement learning environment. Many problems can be formulated as a Markov Decision Process (MDP). To create an environment you need to specify the transition array and reward matrix of the MDP as arguments of the `makeEnvironment` function.

```{r}
P = array(0, c(2, 2, 2))
P[, , 1] = matrix(c(0.5, 0.5, 0, 1), 2, 2, byrow = TRUE)
P[, , 2] = matrix(c(0, 1, 0, 1), 2, 2, byrow = TRUE)
R = matrix(c(5, 10, -1, 2), 2, 2, byrow = TRUE)  
env = makeEnvironment(transitions = P, rewards = R)
```

The function `makeEnvironment` returns an R6 class with a set of attributes and methods. There are attributes describing the properties of the state and action space and methods to interact with the environment.

```{r}
paste("State space:" , env$state.space)
paste("Number of actions:", env$n.actions)

print("Reset the environment")
env$reset()
paste("The state is initially", env$state)
print("Take action 1")
env$step(1)
paste("The state is now", env$state)
paste("And the reward for action 1 was", env$reward)
```
For more details on the creation of environments have a look at the vignette "How to create an environment?".

---

## Solve an environment

Once you have created an environment you can find the optimal way to behave in this environment with one of the implemented algorithms, e.g. Value Iteration, Sarsa or Q-Learning.

```{r}
# Solve the windy gridworld task using Q-Learning
# env = windyGridworld()
# res = qlearning(env)
```

The algorithms return the state or action value function, sometimes also the policy and some statistics about learning behaviour, e.g. the number of steps per episode.

---

Learn more about reinforcement learning in R by having a look at the other vignettes: "How to create an environment?" and "How to solve an environment?".

Author: Markus Dumke
